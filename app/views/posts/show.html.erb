<%- model_class = Post -%>
<div class="page-header">
  <h1><%= @post.topic %></h1>
</div>

<div class="panel panel-default">
  <div class="panel-heading">
    <div class="col-md-1">
      <%= image_tag @post.user.image, :class => 'img-responsive' %>
    </div>
    <ul class="list-inline">
      <li><strong>Votes:</strong>
        <%= @post.votes.sum(:vote) %>
        <% if @current_user.present? %>
          <%= link_to 'up', vote_up_post_path(@post), :class => 'btn btn-default', :role => 'button' %>
          <%= link_to 'down', vote_down_post_path(@post), :class => 'btn btn-default', :role => 'button' %>
        <% end %>
      </li>
      <li><strong>Author:</strong>
      <%= @post.user.name %>
      </li>
      <li><strong>Created:</strong>
      <%= @post.created_at %>
      </li>
      <li><strong>Updated:</strong>
      <%= @post.updated_at %>
      </li>
    </ul>
  </div>
  <div class="panel-body"><%== @post.content_html %></div>
</div>

<% @post.comments.each do |comment| %>
<div class="panel panel-default">
  <div class="panel-heading">
    <div class="col-md-1">
      <%= image_tag comment.user.image, :class => 'img-responsive' %>
    </div>
    <ul class="list-inline">
      <li><strong>Votes:</strong>
        <%= comment.votes.sum(:vote) %>
        <% if @current_user.present? %>
          <%= link_to 'up', vote_up_post_comment_path(@post, comment), :class => 'btn btn-default', :role => 'button' %>
          <%= link_to 'down', vote_down_post_comment_path(@post, comment), :class => 'btn btn-default', :role => 'button' %>
        <% end %>
      </li>
      <li><strong>Author:</strong>
      <%= comment.user.name %>
      </li>
      <li><strong>Created:</strong>
      <%= comment.created_at %>
      </li>
      <li><strong>Updated:</strong>
      <%= comment.updated_at %>
      </li>
    </ul>
    <% if @current_user.present? && @current_user.id == comment.user.id %>
      <%= link_to 'Edit comment', edit_post_comment_path(@post, comment), :class => 'btn btn-default', :role => 'button' %>
    <% end %>

    <% if @current_user.present? && @current_user.admin? %>
      <%= link_to 'Delete comment', post_comment_path(@post, comment), :method => :delete, :data => { :confirm => "Are you sure?"}, :class => 'btn btn-default', :role => 'button' %>
    <% end %>
  </div>
  <div class="panel-body"><%== comment.content_html %></div>
</div>
<% end %>

<%= link_to t('.back', :default => t("helpers.links.back")),
              posts_path, :class => 'btn btn-default'  %>



<% if @current_user.present? %>
    <%= link_to 'Add comment', new_post_comment_path(@post), :class => 'btn btn-default' %>
  <% end %>

  <% if @current_user.present? && (@current_user.id == @post.user.id || @current_user.admin?) %>
    <%= link_to t('.edit', :default => t("helpers.links.edit")),
              edit_post_path(@post), :class => 'btn btn-default' %>
  <% end %>

  <% if @current_user.present? && @current_user.admin? %>
    <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
              post_path(@post),
              :method => 'delete',
              :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
              :class => 'btn btn-danger' %>
  <% end %>